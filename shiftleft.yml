version: 2 # implies that check-analysis v2 should be used and therefore
           # the --v2 flag can be omitted when running sl check-analysis
source:
  #branch: master
  scan: 12 # provide either branch or scan, not both
build_rules:
  - id: "No critical or high SAST findings"
    finding_types:
      - vuln
      - secret
    cvss_31_severity_ratings:
      - critical
      - high
    threshold: 0
    options:
      num_findings: 10 # Return 10 sast findings
  - id: "No reachable SCA findings"
    finding_types:
      - oss_vuln
    cvss_31_severity_ratings:
      - critical
      - high
    threshold: 0
    options:
      reachable: true
      num_findings: 10 # Return 10 reachable sca findings
  - id: "No critical or high container findings"
    finding_types:
      - container
    cvss_31_severity_ratings:
      - critical
      - high
    threshold: 0
    options:
      num_findings: 10 # Return 10 container findings
